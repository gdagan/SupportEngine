{% extends "layout.html" %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}"> 
{% endblock %}

{% block body %} 
<h1>Edit Ticket</h1>
<form action="/edit_ticket" method="post">

  <label for="ticket_id"> ID:</label>
  <input type="text" id="ticket_id" name="ticket_id" value="1" readonly>
  <br>
  <br>

  <label for="category">Category:</label>
  <select id="category" name="category">
    <option value="Hardware">Hardware</option>
    <option value="Software">Software</option>
    <option value="Network">Network</option>
  </select>

  <br>
  <br>
  <label for="priority">Priority:</label>
  <select id="priority" name="priority">
    <option value="Low">Low</option>
    <option value="Medium">Medium</option>
    <option value="High">High</option>
    <option value="Urgent">Urgent</option>
  </select>
  <br>
  <br>

  <label for="description">Description:</label>
  <textarea id="description" name="description" rows="10" cols="50">Issue with the ticket</textarea>
  <br>
  <br>

  <label for="status">Status:</label>
  <select id="status" name="status">
    <option value="Open">Open</option>
    <option value="In Progress">In Progress</option>
    <option value="Closed">Closed</option>
  </select>
  <br>
  
  <br>
  <br>
  <br>
  <br>
  <button type="submit" value="Update_Ticket" >Update Ticket</button>
  <button type="submit" value="cancel" >Cancel</button>
</form>
<script>
  document.getElementById('ticketForm').addEventListener('submit', function (event) {
      event.preventDefault(); // Prevent the default form submission
  
      // Gather form data using FormData
      const formData = new FormData(document.getElementById('ticketForm'));
  
      // Send form data using fetch
      fetch('/edit_ticket', {
          method: 'POST',
          body: formData // Use formData directly
      })
      .then(response => response.json())
      .then(data => {
          if (data.status === true) {
              alert('Ticket updated successfully');
              window.location.href = '/edit_ticket';
          } else {
              alert('Ticket update failed');
          }
        
          console.log(data.message); // Message from the server
      })
      .catch(error => {
          console.error('Error:', error);
      });
  });
  
  </script>

{% endblock %}  

{% block footer %} 

{% endblock %}
